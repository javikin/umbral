---
name: Crear Stats Screen
status: closed
created: 2026-01-05T03:15:00Z
updated: 2026-01-05T03:15:00Z
github:
parallel: false
depends_on: [001, 002]
effort: 8h
---

# Task: Crear Stats Screen

## Descripci√≥n

Crear una pantalla de estad√≠sticas completa con visualizaciones minimalistas del uso y progreso del usuario.

## Dise√±o Visual

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚Üê Estad√≠sticas                     ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  üî• 12                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  D√≠as de racha              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë 80%           ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Mejor racha: 15 d√≠as       ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Intentos bloqueados        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ         ‚ñÅ‚ñÇ‚ñÉ‚ñÖ‚ñÜ‚ñá‚ñà‚ñÜ‚ñÑ‚ñÉ          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  L  M  M  J  V  S  D        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Esta semana: 47            ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Semana pasada: 62 ‚Üì24%    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  ‚è± Tiempo ahorrado          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ~4h 30min esta semana      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  (basado en 5min/intento)   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Apps m√°s bloqueadas        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  1. Instagram    23 ‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  2. TikTok       15 ‚ñì‚ñì‚ñì‚ñì   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  3. Twitter       9 ‚ñì‚ñì     ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## M√©tricas a Mostrar

### 1. Streak Section
- Racha actual (n√∫mero grande)
- Barra de progreso hacia pr√≥ximo milestone
- Mejor racha hist√≥rica
- Badges de milestones conseguidos

### 2. Blocked Attempts
- Gr√°fica de √∫ltimos 7 d√≠as
- Total esta semana
- Comparativa con semana anterior (% cambio)

### 3. Time Saved
- Estimado basado en tiempo promedio por distracci√≥n
- Configurable: default 5 min/intento
- Mostrar en formato legible (Xh Ymin)

### 4. Most Blocked Apps
- Top 3-5 apps m√°s bloqueadas
- Con icono de la app
- Barra de progreso proporcional
- Contador de intentos

## Implementaci√≥n

### StatsScreen.kt

```kotlin
@Composable
fun StatsScreen(
    onNavigateBack: () -> Unit,
    viewModel: StatsViewModel = hiltViewModel()
) {
    val uiState by viewModel.uiState.collectAsState()

    Scaffold(
        topBar = {
            TopAppBar(
                title = { Text("Estad√≠sticas") },
                navigationIcon = {
                    IconButton(onClick = onNavigateBack) {
                        Icon(Icons.AutoMirrored.Filled.ArrowBack, "Volver")
                    }
                }
            )
        }
    ) { padding ->
        LazyColumn(
            modifier = Modifier
                .fillMaxSize()
                .padding(padding)
                .padding(horizontal = UmbralSpacing.screenHorizontal),
            verticalArrangement = Arrangement.spacedBy(UmbralSpacing.md)
        ) {
            item { StreakStatsCard(uiState.streak) }
            item { BlockedAttemptsCard(uiState.weeklyAttempts) }
            item { TimeSavedCard(uiState.timeSaved) }
            item { MostBlockedAppsCard(uiState.topApps) }
        }
    }
}
```

### StreakStatsCard

```kotlin
@Composable
fun StreakStatsCard(streak: StreakStats) {
    UmbralCard {
        Row(verticalAlignment = Alignment.CenterVertically) {
            Text("üî•", fontSize = 40.sp)
            Spacer(Modifier.width(UmbralSpacing.md))
            Column {
                Text(
                    "${streak.current}",
                    style = MaterialTheme.typography.displayLarge
                )
                Text(
                    "D√≠as de racha",
                    style = MaterialTheme.typography.bodyMedium,
                    color = MaterialTheme.colorScheme.onSurfaceVariant
                )
            }
        }

        Spacer(Modifier.height(UmbralSpacing.md))

        // Progress to next milestone
        val nextMilestone = listOf(7, 30, 100, 365)
            .firstOrNull { it > streak.current } ?: 365

        LinearProgressIndicator(
            progress = { streak.current.toFloat() / nextMilestone },
            modifier = Modifier.fillMaxWidth()
        )

        Text(
            "${nextMilestone - streak.current} d√≠as para pr√≥ximo logro",
            style = MaterialTheme.typography.bodySmall
        )

        Spacer(Modifier.height(UmbralSpacing.sm))

        Text(
            "Mejor racha: ${streak.best} d√≠as",
            style = MaterialTheme.typography.bodyMedium
        )
    }
}
```

### BlockedAttemptsCard

```kotlin
@Composable
fun BlockedAttemptsCard(attempts: WeeklyAttempts) {
    UmbralCard {
        Text(
            "Intentos bloqueados",
            style = MaterialTheme.typography.titleMedium
        )

        Spacer(Modifier.height(UmbralSpacing.md))

        StatsGraph(
            data = attempts.daily.map { it.toFloat() },
            modifier = Modifier
                .fillMaxWidth()
                .height(100.dp)
        )

        // Day labels
        Row(
            modifier = Modifier.fillMaxWidth(),
            horizontalArrangement = Arrangement.SpaceBetween
        ) {
            listOf("L", "M", "M", "J", "V", "S", "D").forEach {
                Text(it, style = MaterialTheme.typography.bodySmall)
            }
        }

        Spacer(Modifier.height(UmbralSpacing.md))

        Row {
            Text("Esta semana: ${attempts.thisWeek}")
            Spacer(Modifier.weight(1f))

            val change = attempts.percentChange
            val color = if (change < 0) UmbralSuccess else UmbralError
            val arrow = if (change < 0) "‚Üì" else "‚Üë"

            Text(
                "vs anterior: $arrow${abs(change)}%",
                color = color
            )
        }
    }
}
```

## Data Models

```kotlin
data class StatsUiState(
    val isLoading: Boolean = true,
    val streak: StreakStats = StreakStats(),
    val weeklyAttempts: WeeklyAttempts = WeeklyAttempts(),
    val timeSaved: Duration = Duration.ZERO,
    val topApps: List<BlockedAppStats> = emptyList()
)

data class StreakStats(
    val current: Int = 0,
    val best: Int = 0,
    val milestones: List<Int> = emptyList()
)

data class WeeklyAttempts(
    val daily: List<Int> = List(7) { 0 },
    val thisWeek: Int = 0,
    val lastWeek: Int = 0,
    val percentChange: Int = 0
)

data class BlockedAppStats(
    val packageName: String,
    val appName: String,
    val count: Int
)
```

## Archivos a Crear

- `StatsScreen.kt`
- `StatsViewModel.kt`
- `StreakStatsCard.kt`
- `BlockedAttemptsCard.kt`
- `TimeSavedCard.kt`
- `MostBlockedAppsCard.kt`

## Criterios de Aceptaci√≥n

- [ ] Todas las secciones muestran datos reales
- [ ] Gr√°ficas con animaci√≥n de entrada
- [ ] Comparativas semana vs anterior
- [ ] Top apps con iconos correctos
- [ ] Dark mode funciona
- [ ] Loading state mientras carga datos
