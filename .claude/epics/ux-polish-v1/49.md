---
name: Stats Card - Datos reales y empty state
status: closed
created: 2026-01-06T17:01:04Z
updated: 2026-01-06T17:54:45Z
github: https://github.com/javikin/umbral/issues/49
depends_on: []
parallel: true
conflicts_with: [51]
---

# Task: Stats Card - Datos reales y empty state

## Description

El card de estadísticas en HomeScreen muestra datos hardcodeados (mock data) en lugar de datos reales. Esto engaña al usuario haciéndole creer que hay actividad cuando no la hay.

**Problemas actuales:**
1. `weeklyData = listOf(0.3f, 0.5f, 0.4f, 0.8f, 0.6f, 0.9f, 0.7f)` - datos falsos
2. No hay empty state cuando no hay datos reales
3. El click navega correctamente (esto ya funciona)

## Acceptance Criteria

- [ ] Sin datos: muestra empty state con mensaje "Sin datos todavía"
- [ ] Con datos: muestra gráfica con datos reales del repositorio
- [ ] No hay valores hardcodeados de estadísticas en el código
- [ ] Click en el card navega a StatsScreen (ya funciona, verificar)
- [ ] Animaciones de entrada se mantienen

## Technical Details

### Archivos a modificar:

1. **`HomeViewModel.kt`** - Agregar datos de stats
```kotlin
data class HomeUiState(
    // ... existentes
    val weeklyStats: List<Float> = emptyList(),
    val hasStatsData: Boolean = false
)

// En el ViewModel, cargar stats reales:
private fun loadWeeklyStats() {
    viewModelScope.launch {
        statsRepository.getWeeklyStats().collect { stats ->
            _uiState.update { it.copy(
                weeklyStats = stats,
                hasStatsData = stats.any { it > 0f }
            )}
        }
    }
}
```

2. **`HomeScreen.kt`** - Modificar StatsPreviewCard

```kotlin
// Cambiar de:
StatsPreviewCard(
    weeklyData = listOf(0.3f, 0.5f, 0.4f, 0.8f, 0.6f, 0.9f, 0.7f), // MOCK
    onClick = onStatsClick
)

// A:
StatsPreviewCard(
    weeklyData = uiState.weeklyStats,
    hasData = uiState.hasStatsData,
    onClick = onStatsClick
)
```

3. **`StatsPreviewCard` (dentro de HomeScreen.kt)** - Agregar empty state

```kotlin
@Composable
private fun StatsPreviewCard(
    weeklyData: List<Float>,
    hasData: Boolean,
    onClick: () -> Unit,
    modifier: Modifier = Modifier
) {
    UmbralCard(
        modifier = modifier.fillMaxWidth(),
        elevation = UmbralElevation.Subtle,
        onClick = onClick
    ) {
        Row(
            modifier = Modifier.fillMaxWidth(),
            verticalAlignment = Alignment.CenterVertically
        ) {
            Text(
                text = "Estadísticas",
                style = MaterialTheme.typography.titleMedium,
                fontWeight = FontWeight.SemiBold
            )
            Spacer(modifier = Modifier.weight(1f))
            Icon(
                imageVector = Icons.AutoMirrored.Filled.KeyboardArrowRight,
                contentDescription = "Ver más",
                tint = MaterialTheme.colorScheme.onSurfaceVariant
            )
        }

        Spacer(modifier = Modifier.height(UmbralSpacing.md))

        if (hasData) {
            StatsGraph(
                data = weeklyData,
                modifier = Modifier.fillMaxWidth().height(100.dp),
                labels = listOf("L", "M", "X", "J", "V", "S", "D"),
                showLabels = true
            )
            Spacer(modifier = Modifier.height(UmbralSpacing.sm))
            Text(
                text = "Últimos 7 días",
                style = MaterialTheme.typography.bodySmall,
                color = MaterialTheme.colorScheme.onSurfaceVariant
            )
        } else {
            // Empty state
            Column(
                modifier = Modifier.fillMaxWidth().padding(vertical = UmbralSpacing.lg),
                horizontalAlignment = Alignment.CenterHorizontally
            ) {
                Text(
                    text = "Sin datos todavía",
                    style = MaterialTheme.typography.bodyLarge,
                    color = MaterialTheme.colorScheme.onSurfaceVariant
                )
                Spacer(modifier = Modifier.height(UmbralSpacing.xs))
                Text(
                    text = "Activa un perfil para comenzar a trackear",
                    style = MaterialTheme.typography.bodySmall,
                    color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.7f)
                )
            }
        }
    }
}
```

### Verificar StatsRepository

Asegurar que existe un método para obtener stats semanales:
```kotlin
interface StatsRepository {
    fun getWeeklyStats(): Flow<List<Float>>
}
```

## Dependencies

- [ ] `StatsRepository` debe tener método `getWeeklyStats()`
- [ ] Verificar que la navegación a StatsScreen funciona

## Effort Estimate

- Size: M
- Hours: 1.25
- Parallel: true (pero conflicts_with: 004 por modificar HomeScreen)

## Definition of Done

- [ ] Código implementado
- [ ] Empty state visible cuando no hay datos
- [ ] Datos reales mostrados cuando existen
- [ ] No hay mock data hardcodeado
- [ ] Probado en dispositivo real
