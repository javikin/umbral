---
name: Simplificar flujo de onboarding
status: closed
created: 2026-01-06T17:01:04Z
updated: 2026-01-06T17:54:45Z
github: https://github.com/javikin/umbral/issues/50
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Simplificar flujo de onboarding

## Description

El onboarding actual incluye un paso de "Seleccionar apps a bloquear" que es redundante con el flujo de creación de perfil. Esto hace el onboarding más largo y crea duplicación de código/UI.

**Flujo actual:**
1. Welcome
2. How it works
3. How to unlock
4. Permissions
5. **Select apps** ← ELIMINAR
6. Success

**Flujo objetivo:**
1. Welcome
2. How it works
3. How to unlock
4. Permissions
5. Success (ajustado)

## Acceptance Criteria

- [ ] Onboarding tiene máximo 5 pasos (sin selección de apps)
- [ ] Navegación de `permissions` va directamente a `success`
- [ ] `SuccessScreen` no menciona cantidad de apps seleccionadas
- [ ] `SuccessScreen` invita a crear primer perfil
- [ ] No hay errores de navegación ni crasheos
- [ ] `SelectAppsScreen` se puede eliminar o deprecar

## Technical Details

### 1. Modificar `OnboardingNavHost.kt`

**Cambiar navegación de permissions:**
```kotlin
// ANTES (líneas 87-98):
composable("permissions") {
    PermissionsScreen(
        viewModel = viewModel,
        onContinue = {
            viewModel.nextStep()
            navController.navigate("select_apps") {  // ← Cambia aquí
                popUpTo("welcome") { inclusive = true }
            }
        }
    )
}

// DESPUÉS:
composable("permissions") {
    PermissionsScreen(
        viewModel = viewModel,
        onContinue = {
            viewModel.completeOnboardingSimple()  // Nueva función
            navController.navigate("success") {
                popUpTo("welcome") { inclusive = true }
            }
        }
    )
}
```

**Eliminar o comentar la ruta `select_apps` (líneas 100-119):**
```kotlin
// Ya no necesaria - eliminar o comentar
// composable("select_apps") { ... }
```

### 2. Modificar `OnboardingViewModel.kt`

**Agregar función simplificada:**
```kotlin
fun completeOnboardingSimple() {
    viewModelScope.launch {
        // Marcar onboarding como completado sin crear perfil
        onboardingManager.setOnboardingCompleted(true)
    }
}
```

### 3. Modificar `SuccessScreen.kt`

**Ajustar UI para no mostrar apps:**
```kotlin
@Composable
fun SuccessScreen(
    onStartBlocking: () -> Unit,
    onLater: () -> Unit,
    modifier: Modifier = Modifier
) {
    // Nuevo diseño sin mención de apps
    Column(
        modifier = modifier
            .fillMaxSize()
            .padding(24.dp),
        horizontalAlignment = Alignment.CenterHorizontally,
        verticalArrangement = Arrangement.Center
    ) {
        // Icono de éxito
        Icon(
            imageVector = Icons.Default.CheckCircle,
            contentDescription = null,
            modifier = Modifier.size(80.dp),
            tint = MaterialTheme.colorScheme.primary
        )

        Spacer(modifier = Modifier.height(24.dp))

        Text(
            text = "¡Todo listo!",
            style = MaterialTheme.typography.headlineMedium,
            fontWeight = FontWeight.Bold
        )

        Spacer(modifier = Modifier.height(8.dp))

        Text(
            text = "Ya puedes crear tu primer perfil de bloqueo",
            style = MaterialTheme.typography.bodyLarge,
            textAlign = TextAlign.Center,
            color = MaterialTheme.colorScheme.onSurfaceVariant
        )

        Spacer(modifier = Modifier.height(32.dp))

        Button(
            onClick = onStartBlocking,
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("Crear primer perfil")
        }

        Spacer(modifier = Modifier.height(12.dp))

        TextButton(onClick = onLater) {
            Text("Más tarde")
        }
    }
}
```

### 4. Limpiar imports no usados

En `OnboardingNavHost.kt`, remover import de `SelectAppsScreen` si ya no se usa.

## Dependencies

- [ ] Ninguna - cambios independientes en módulo onboarding

## Effort Estimate

- Size: S
- Hours: 0.75
- Parallel: true

## Definition of Done

- [ ] Onboarding completado sin paso de selección de apps
- [ ] SuccessScreen muestra mensaje actualizado
- [ ] Sin errores de compilación
- [ ] Flujo probado en dispositivo real
- [ ] Fresh install funciona correctamente
