---
name: Toggle de bloqueo de notificaciones por perfil
status: open
created: 2026-01-16T15:32:16Z
updated: 2026-01-16T15:32:16Z
github: https://github.com/javikin/umbral/issues/78
depends_on: [77]
parallel: false
conflicts_with: []
---

# Task: Toggle de bloqueo de notificaciones por perfil

## Description

Permitir que cada perfil de bloqueo pueda habilitar o deshabilitar el bloqueo de notificaciones de forma independiente. Algunos usuarios pueden querer bloquear apps pero seguir recibiendo sus notificaciones.

## Acceptance Criteria

- [ ] Nuevo campo `blockNotifications: Boolean` en el modelo `Profile`
- [ ] Toggle "Bloquear notificaciones" visible en `ProfileDetailScreen`
- [ ] Migración de Room para agregar la columna (default: true)
- [ ] `UmbralNotificationService` respeta esta configuración del perfil activo
- [ ] Cuando está deshabilitado, las notificaciones de apps bloqueadas SÍ aparecen
- [ ] Cuando está habilitado (default), las notificaciones se bloquean como antes

## Technical Details

### 1. Modelo Profile
```kotlin
data class Profile(
    val id: String,
    val name: String,
    val blockedApps: List<String>,
    val isActive: Boolean,
    val blockNotifications: Boolean = true, // NEW
    // ...
)
```

### 2. Room Migration
```kotlin
val MIGRATION_X_Y = object : Migration(X, Y) {
    override fun migrate(database: SupportSQLiteDatabase) {
        database.execSQL(
            "ALTER TABLE profiles ADD COLUMN blockNotifications INTEGER NOT NULL DEFAULT 1"
        )
    }
}
```

### 3. ProfileDetailScreen UI
Agregar switch después de la lista de apps bloqueadas:
- Label: "Bloquear notificaciones"
- Descripción: "Oculta notificaciones de las apps bloqueadas"

### 4. UmbralNotificationService
```kotlin
// En onNotificationPosted
val activeProfile = getActiveProfile()
if (activeProfile?.blockNotifications == false) {
    // No bloquear notificaciones para este perfil
    return
}
// ... resto de lógica de bloqueo
```

## Dependencies

- [x] #77: Timer y resumen (completado)

## Effort Estimate

- Size: S
- Hours: 1-2
